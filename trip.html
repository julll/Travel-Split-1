<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TravelSplit - –ü–æ–µ–∑–¥–∫–∞</title>
    <link rel="stylesheet" href="trip-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ–µ–∑–¥–∫–∏ -->
        <header class="trip-header">
            <button class="btn-back" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="trip-info">
                <h1 id="trip-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
                <div class="trip-meta">
                    <span id="trip-location" class="trip-location"></span>
                    <span id="trip-dates" class="trip-dates"></span>
                </div>
            </div>
            <div class="firebase-status">
                <span class="firebase-badge">üî•</span>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <section class="quick-actions">
                <button class="action-btn" onclick="showAddParticipantModal()">
                    <i class="fas fa-user-plus"></i>
                    <span>–£—á–∞—Å—Ç–Ω–∏–∫</span>
                </button>
                <button class="action-btn" onclick="showAddExpenseModal()">
                    <i class="fas fa-receipt"></i>
                    <span>–†–∞—Å—Ö–æ–¥</span>
                </button>
                <button class="action-btn" onclick="showTransferModal()">
                    <i class="fas fa-exchange-alt"></i>
                    <span>–ü–µ—Ä–µ–≤–æ–¥</span>
                </button>
            </section>

            <!-- –ë–∞–ª–∞–Ω—Å—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ -->
            <section class="balances-section">
                <div class="section-header">
                    <h2><i class="fas fa-balance-scale"></i> –ë–∞–ª–∞–Ω—Å—ã</h2>
                </div>
                <div class="balances-container">
                    <div id="balances-list" class="balances-list">
                        <!-- –ë–∞–ª–∞–Ω—Å—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    <div class="chart-container">
                        <canvas id="balances-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã -->
            <section class="expenses-section">
                <div class="section-header">
                    <h2><i class="fas fa-receipt"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</h2>
                    <button class="btn btn-outline btn-sm" onclick="showAllExpenses()">
                        <i class="fas fa-list"></i> –í—Å–µ —Ä–∞—Å—Ö–æ–¥—ã
                    </button>
                </div>
                <div id="recent-expenses" class="recent-expenses">
                    <!-- –†–∞—Å—Ö–æ–¥—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </section>

            <!-- –ú–∞—Ç—Ä–∏—Ü–∞ –¥–æ–ª–≥–æ–≤ -->
            <section class="debt-section">
                <div class="section-header">
                    <h2><i class="fas fa-exchange-alt"></i> –ö—Ç–æ –∫–æ–º—É –¥–æ–ª–∂–µ–Ω</h2>
                </div>
                <div id="debt-matrix" class="debt-matrix">
                    <!-- –ú–∞—Ç—Ä–∏—Ü–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </section>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->

    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ -->
    <div id="add-participant-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞</h3>
                <span class="close" onclick="hideAddParticipantModal()">&times;</span>
            </div>
            <form id="add-participant-form" class="modal-form">
                <div class="form-group">
                    <label for="participant-name">–ò–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ *</label>
                    <input type="text" id="participant-name" name="name" required 
                           placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–Ω–Ω–∞">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="hideAddParticipantModal()">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ -->
    <div id="add-expense-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3><i class="fas fa-receipt"></i> –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h3>
                <span class="close" onclick="hideAddExpenseModal()">&times;</span>
            </div>
            <form id="add-expense-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="expense-payer">–ö—Ç–æ –ø–ª–∞—Ç–∏–ª *</label>
                        <select id="expense-payer" name="payer" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="expense-amount">–°—É–º–º–∞ *</label>
                        <input type="number" id="expense-amount" name="amount" required 
                               min="0" step="0.01" placeholder="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="expense-description">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                    <input type="text" id="expense-description" name="description" required 
                           placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –£–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ">
                </div>

                <div class="form-group">
                    <label for="expense-date">–î–∞—Ç–∞</label>
                    <input type="date" id="expense-date" name="date">
                </div>

                <div class="form-group">
                    <label>–ö–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ä–∞—Å—Ö–æ–¥?</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="split-type" value="equal" checked>
                            <span>–ü–æ—Ä–æ–≤–Ω—É –º–µ–∂–¥—É –≤—Å–µ–º–∏</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="split-type" value="custom">
                            <span>–£–∫–∞–∑–∞—Ç—å —Å—É–º–º—ã –≤—Ä—É—á–Ω—É—é</span>
                        </label>
                    </div>
                </div>

                <div id="custom-splits" class="custom-splits" style="display: none;">
                    <h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º:</h4>
                    <div id="splits-container" class="splits-container">
                        <!-- –ü–æ–ª—è –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è -->
                    </div>
                    <div class="splits-summary">
                        <span>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ: <strong id="splits-total">0</strong> ‚ÇΩ</span>
                        <span>–û—Å—Ç–∞—Ç–æ–∫: <strong id="splits-remaining">0</strong> ‚ÇΩ</span>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="hideAddExpenseModal()">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ü–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥ -->
    <div id="transfer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exchange-alt"></i> –ü–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥</h3>
                <span class="close" onclick="hideTransferModal()">&times;</span>
            </div>
            <form id="transfer-form" class="modal-form">
                <div class="form-group">
                    <label for="transfer-from">–û—Ç –∫–æ–≥–æ *</label>
                    <select id="transfer-from" name="from" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="transfer-to">–ö–æ–º—É *</label>
                    <select id="transfer-to" name="to" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="transfer-amount">–°—É–º–º–∞ *</label>
                    <input type="number" id="transfer-amount" name="amount" required 
                           min="0" step="0.01" placeholder="0">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="hideTransferModal()">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-check"></i> –ó–∞–ø–∏—Å–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Å–µ—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
    <div id="all-expenses-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3><i class="fas fa-list"></i> –í—Å–µ —Ä–∞—Å—Ö–æ–¥—ã</h3>
                <span class="close" onclick="hideAllExpensesModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="all-expenses-list" class="all-expenses-list">
                    <!-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <!-- üî• –ò–°–ü–û–õ–¨–ó–£–ï–ú FIREBASE –í–ï–†–°–ò–Æ -->
    <script src="firebase-database.js"></script>
    <script src="trip.js"></script>
</body>
</html>